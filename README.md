# kasperskyTestAdvanced

### Усложненная версия задания:

Требуется реализовать два приложения для Linux или macOS:
1. Сервисное приложение, ожидающее команд на сканирование файлов в директориях и выполняющее сканирование файлов в директориях, с целью нахождение в них “подозрительных” (suspicious) файлов;
2. Утилиту, работающую из командной строки, отправляющую сервисному приложению команду на сканирование файлов в указанной директории. 

### В рамках задачи определено 3 типа “подозрительного” содержимого в файле.
* JS suspicious: файл с расширением .js, содержащий строку: ```<script>evil_script()</script>```
* Unix suspicious: любой файл, содержащий строку: ```rm -rf ~/Documents```
* macOS suspicious: любой файл, содержащий строку: ```system("launchctl load /Library/LaunchAgents/com.malware.agent")```

### Утилита должна дожидаться выполнения отправленной команды и по её итогам утилита должна вывести пользователю отчет о сканировании, в котором присутствует следующая информация:
* общее количество обработанных файлов;
* количество детектов на каждый тип “подозрительного” содержимого;
* количество ошибок анализа файлов (например, не хватает прав на чтение файла);
* время выполнения утилиты.
 

### Пример запуска сервера и исполнения утилиты из командной строки:
```
$ ./scan_service &
[1] 1234
== Scan service is started ==
 ```
```
$ ./scan_util /Users/user/Downloads
====== Scan result ======
Processed files: 150
JS detects: 5
Unix detects: 1
macOS detects: 2
Errors: 1
Exection time: 00:00:31 
=========================
```
 
### Тестирование
Для тестирования приложен скрипт ```scriptForTest.py```. Скрипт создает файлы с рандомным содержанием. Колличество файлов задается в скрипте. Вывод скрипта позволит сверится с результатом
```
Processed files: 1
JS detects: 2
Unix detects: 0
macOS detects: 0
```

### Добавление/удаление подозрительных строк
Чтобы добавить новую подорзительность или удлаить старую, нужно в файле ```Suspicions.h```:
 1. Добавить/удалить ```SuspicionType```
 2. Увеличить/уменьшить ```suspicionCount```
 3. Добавить/удалить пару в ```suspicionArray```
 4. Добавить/удалить имя угрозы в ```suspicionNames```
